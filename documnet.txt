===== Changes Log =====
Date: 2026-02-19

--- File Modified: Dockerfile ---
Location: e:\sdc-joint.ai\backend\sdc-joint-ai\Dockerfile

What was changed:
- Completely rewrote the Dockerfile from scratch.

Previous state:
- Used ghcr.io/astral-sh/uv:python3.13-bookworm-slim as base image (UV package manager).
- WORKDIR was /app.
- Dependencies installed via `uv sync --locked` using pyproject.toml and uv.lock.
- Ran with `uv run src/agent.py start`.
- Had a non-privileged appuser setup.
- Had a pre-download step: `uv run src/agent.py download-files`.

New state:
- Base image: python:3.13-slim-bookworm (standard Python image, no UV).
- WORKDIR: /sdc-joint-ai (as requested).
- Creates a Python virtual environment: `python -m venv venv`.
- Installs dependencies with: `pip install -r requirement.txt`.
- Runs the app with: `venv/bin/python src/agent.py start`.
- Removed the non-privileged user setup for simplicity.
- Removed the `download-files` pre-download step.
- Kept build dependencies (gcc, g++, python3-dev) for native extensions.

--- AWS Deployment Guide Created (Console UI Version) ---
Location: Artifact file (aws_deployment_guide.md)

What was created:
- A complete step-by-step AWS deployment guide using AWS Console UI (web).
- Uses ECS Fargate for serverless container deployment.
- Steps: Create ECR repo → Push Docker image → Create ECS cluster →
  Create Task Definition with env vars → Create Service → Verify logs.
- Only terminal commands needed: Docker build & push (4 commands).
- Estimated cost: ~$35-45/month.

--- SQL Schema File Created ---
Location: e:\sdc-joint.ai\backend\sdc-joint-ai\supabase_schema.sql

What was created:
- Complete Supabase SQL schema with 6 tables:
  1. helpdesk_requests (requester_name, requester_email, phone_number, request_text, status)
  2. student_complaints (student_name, student_email, department, complaint_text, status)
  3. clubs (club_name, description, head_of_club, contact_email)
  4. club_programs (club_id FK->clubs, program_name, description, program_date, start_time, end_time, venue)
  5. events (event_name, description, event_date, start_time, end_time, venue, department, registrationlink)
  6. exam_timetable (semester, subject_name, exam_date, exam_time, venue, department)
- All tables have RLS (Row Level Security) policies enabled.
- Public read + helpdesk/complaints have public insert.
- Everything else requires authenticated user for insert/update/delete.
- No storage buckets used.

--- Skill/Workflow File Created ---
Location: e:\sdc-joint.ai\.agent\workflows\supabase-schema.md
- Step-by-step instructions for running the SQL in Supabase SQL Editor.
- Column reference documentation for all 6 tables.

--- Example Seed Data Added ---
Location: e:\sdc-joint.ai\backend\sdc-joint-ai\supabase_schema.sql (bottom of file)

What was added:
- Sample INSERT data for all 6 tables:
  - 3 helpdesk requests (Pending, In Progress, Resolved)
  - 4 student complaints (across CSE, ECE, MBA, Civil)
  - 5 clubs (Coding, Robotics, Literary, Sports, Cultural)
  - 6 club programs (linked to clubs above)
  - 5 events (Tech Fest, Placement Drive, Science Day, Sports Day, MBA Visit)
  - 8 exam timetable entries (across Sem 2, 4, 6 for multiple departments)

--- EC2 Deployment Guide Created ---
Date: 2026-02-20
Location: e:\sdc-joint.ai\backend\sdc-joint-ai\EC2_DEPLOYMENT_GUIDE.md

What was created:
- Complete step-by-step guide to deploy the LiveKit Agents backend to AWS EC2 using Docker.
- Covers: EC2 instance launch (t3.small), SSH connection (Windows PowerShell & PuTTY),
  Docker installation (Amazon Linux & Ubuntu), Git clone, .env file creation,
  Docker build & run, container management, and a quick update script.
- Security Group rules: SSH (22), LiveKit WebSocket (7880), HTTPS (443).
- Production run with --restart unless-stopped for auto-recovery.
- Includes update-agent.sh script for one-command code deployments.
- Cost estimate: ~$18-22/month.
- Security best practices and troubleshooting table included.

--- Docker Build Fixes for EC2 (CPU-only) ---
Date: 2026-02-20
Files Modified: requirement.txt, Dockerfile

Issues fixed:
1. torchaudio==2.9.0+cpu → torchaudio==2.9.0
   - The +cpu suffix is only available from PyTorch's custom index URL, not standard PyPI.
   - Changed to standard version which works on both CPU and GPU machines.

2. Removed onnxruntime-gpu==1.23.0
   - EC2 t3.small has no GPU/CUDA, so gpu variant is unnecessary and may fail.
   - onnxruntime==1.23.1 (CPU version) is already listed and sufficient.

3. Removed pyreadline3==3.5.4
   - This is a Windows-only package (readline replacement for Windows).
   - On Linux (Docker), readline is built-in — this package fails or is useless.

4. Dockerfile: Added libportaudio2 and libsndfile1 to apt-get install
   - Required by sounddevice Python package for audio I/O on Linux.

--- Fix: Disk Space Error (torch CUDA → CPU-only) ---
Date: 2026-02-20
Files Modified: Dockerfile, requirement.txt

Problem:
- Docker build failed with "No space left on device" on 20GB EC2 disk.
- Standard PyPI torch==2.9.0 downloads ~4GB of NVIDIA CUDA libraries
  (nvidia-cublas, nvidia-cudnn, nvidia-cusparse, triton, etc.)
  that are unnecessary on a CPU-only EC2 t3.small instance.

Fix:
- Dockerfile: Added a separate pip install step BEFORE requirement.txt that
  installs torch==2.9.0+cpu and torchaudio==2.9.0+cpu from PyTorch's
  CPU-only index (https://download.pytorch.org/whl/cpu).
  CPU-only torch is ~200MB vs ~4GB with CUDA.
- requirement.txt: Commented out torch and torchaudio lines so pip
  doesn't re-download the CUDA versions from standard PyPI.

--- Fix: Missing LiveKit Plugins ---
Date: 2026-02-20
File Modified: requirement.txt

Problem:
- Agent crashes with: ModuleNotFoundError: No module named 'livekit.plugins.elevenlabs'
- agent.py imports livekit.plugins.elevenlabs (line 25) and livekit.plugins.assemblyai (line 26)
  but neither package was listed in requirement.txt.

Fix:
- Added livekit-plugins-assemblyai==1.2.15 to requirement.txt
- Added livekit-plugins-elevenlabs==1.2.15 to requirement.txt
- Version 1.2.15 matches the other livekit-plugins packages already listed.

--- Fix: Missing Supabase Dependency ---
Date: 2026-02-20
File Modified: requirement.txt

Problem:
- Agent crashes with: ModuleNotFoundError: No module named 'supabase'
- agent.py imports supabase on line 27 but it was missing from requirement.txt.

Fix:
- Added supabase==2.22.1 to requirement.txt (matching locally installed version).
--- Fix: Vercel Build TypeScript Error (chat-transcript.tsx) ---
Date: 2026-02-20
File Modified: e:\sdc-joint.ai\frontend\sdc-joint-frontend\components\app\chat-transcript.tsx

Problem:
- Vercel build failed with TypeScript type error at line 121.
- Error: Type 'string' is not assignable to type 'Easing | Easing[] | undefined'.
- The `ease: 'easeOut'` in CONTAINER_MOTION_PROPS was inferred as generic `string`
  by TypeScript, but Framer Motion (motion/react) expects the specific literal type.
- Also found typo: `stagerDelay` (invalid property, should be `staggerDelay`).

Fix:
- Added `as const` to `ease: 'easeOut' as const` in both hidden and visible variants.
- Added `as const` to `initial`, `animate`, and `exit` string values.
- Removed the invalid `stagerDelay: 0.2` property (typo, not a valid Framer Motion prop).
- This ensures TypeScript infers exact literal types instead of generic `string`.
